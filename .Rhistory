cdf(data)
ecdf(data)
ecdf(data[1])
View(data1)
glm(data ~ alpha + beta * x,family = poisson(link = log))
glm(data ~ 0.2 + 1 * x,family = poisson(link = log))
glm(data ~ x^2,family = poisson(link = log))
glm(data ~ data^2,family = poisson(link = log))
glm(data[2] ~ x^2,family = poisson(link = log))
glm(y ~ nwell,family = poisson(link = log))
glm(data ~ nwell,family = poisson(link = log))
View(data)
View(data)
glm(data$nwell ~ nwell,family = poisson(link = log))
glm(data$nwell ~ x^"",family = poisson(link = log))
glm(data$nwell ~ x^2,family = poisson(link = log))
glm(data$nwell,family = poisson(link = log))
glm(y ~ nwell,family = poisson(link = log), data = data)
file = 'Data/wells.txt'
well.data <- read.table(file, header = TRUE, sep = "", dec = ".")
glm(y ~ nwell,family = poisson(link = log), data = well.data)
glm(village ~ nwell,family = poisson(link = log), data = well.data)
glm(conc ~ nwell,family = poisson(link = log), data = well.data)
summary <- glm(conc ~ nwell,family = poisson(link = log), data = well.data)
plot(summary)
plot(summary)
plot(summary)
summary <- glm(conc ~ nwell,family = normal(link = log), data = well.data)
summary <- glm(conc ~ nwell,family = binomial(link = logit), data = well.data)
file = 'Data/wells.txt'
well.data <- read.table(file, header = TRUE, sep = "", dec = ".")
summary <- glm(conc ~ nwell,family = poisson(link = log), data = well.data)
plot(summary)
2+2
2+5
file = 'Data/wells.txt'
well.data <- read.table(file, header = TRUE, sep = "", dec = ".")
summary <- glm(conc ~ nwell,family = poisson(link = log), data = well.data)
plot(summary)
clc
clear
clc
help()
help(help)
help(for)
help("for")
for (i in 1:10) i
i
i
i
for (i in range(1:10)
for (i in range(1:10) )
for (i in (1:10) )
i
for (i in 1:10)
i
for (i in 1:10)
i
i
i
print(i)
for (i in 1:10)
print(i)
for (i in 10)
print(i)
for (i in 10)
print(i)
for (i in 0:10)
print(i)
summary <- glm(conc ~ nwell,family = poisson(link = log), data = well.data)
file = 'Data/wells.txt'
well.data <- read.table(file, header = TRUE, sep = "", dec = ".")
summary <- glm(conc ~ nwell,family = poisson(link = log), data = well.data)
file = 'Data/wells.txt'
well.data <- read.table(file, header = TRUE, sep = "", dec = ".")
summary <- glm(conc ~ nwell,family = poisson(link = log), data = well.data)
file = 'Data/wells.txt'
well.data <- read.table(file, header = TRUE, sep = "", dec = ".")
summary <- glm(conc ~ nwell,family = poisson(link = log), data = well.data)
summary
# Joachim wd
setwd("/Users/JoachimPorsA/Documents/4. Semester - DTU/Fagprojekt/Data/Arsenik i vand/Data")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
fblad1 <- fblad[c(15:549), ]
N <- length(fblad1$events)
p.hat <- sum(fblad1$events/N)
# sæt en formel til glm
var <- fblad1$conc
analysis<-glm(events~var,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original<-exp(prediction.data)
# plots i log transformation
plot(var,prediction.data$pred, col="blue")
lines(var,prediction.data$lower, col="red")
lines(var,prediction.data$upper, col="red")
#index for undersøgelses punkt
i1 <- 255
# sandsynlighhed for at få kræft i indexpunktet
p1 <- fblad1$events[i1]/fblad1$at.risk[i1]*100
#plot af sandsynlighed for kræft i orginal data
plot(prediction.data.original$pred,var)
lines(prediction.data.original$lower,var, col="red")
lines(prediction.data.original$upper,var, col="red")
points(var[i1],p1,col="green")
## Se info om data
?airquality
## Indlæs data
Air <- airquality
head(Air)
## Fjern rækker hvor der er mindst en NA værdi
Air <- Air[!apply(is.na(Air), 1, any), ]
## Se lige på empirisk tæthedsfunktion
hist(Air$Ozone, probability=TRUE, xlab="Ozon", main="")
## Koncentrationer er positive og meget højre-skæv fordeling, derfor log transformer
Air$logOzone <- log(Air$Ozone)
## Bedre epdf?
hist(Air$logOzone, probability=TRUE, xlab="log Ozon", main="")
# Hvad er der i Air?
head(Air)
tail(Air)
str(Air)
plot(Air[,c("Ozone","Solar.R","Wind","Temp","Month")])
pairs(Air, panel = panel.smooth, main = "airquality data")
##################################################
# Forste fit (ikke transformerede)
fit1 <- lm(Ozone ~ Temp, data = Air)
summary(fit1)
par(mfrow=c(1,3))
qqnorm(fit1$residuals)
qqline(fit1$residuals)
plot(fit1$fitted,fit1$residuals)
hist(fit1$residuals)
##################################################
# Fit 2 (log transformeret)
fit2 <- lm(logOzone ~ Temp, data = Air)
summary(fit2)
par(mfrow=c(2,2))
qqnorm(fit2$residuals)
qqline(fit2$residuals)
plot(fit2$fitted,fit2$residuals,pch=19)
hist(fit2$residuals)
plot(fit2$residuals,pch=19,xlab="Time")
# Vurdering af uafhængighed
par(mfrow=c(1,1))
n <- length(fit2$residuals)
plot(fit2$residuals[-1],fit2$residuals[-n])
cor(fit2$residuals[-1],fit2$residuals[-n])
## Kunne vi bruge andre forklarende variable?
pairs(cbind(fit2$residuals,Air[,c("Solar.R","Wind","Temp")]),
panel = panel.smooth)
round(cor(cbind(fit2$residuals,Air[,c("Solar.R","Wind","Temp")])),digits=3)
## Ny model
fit3 <- lm(logOzone ~ Temp + Solar.R, data = Air)
summary(fit3)
# Joachim wd
setwd("/Users/JoachimPorsA/Documents/4. Semester - DTU/Fagprojekt/Data/Arsenik i vand/Data")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
fblad1 <- fblad[c(15:549), ]
N <- length(fblad1$events)
p.hat <- sum(fblad1$events/N)
# sæt en formel til glm
conc <- fblad1$conc
analysis<-glm(events~conc,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
age <- fblad1$age
analysis<-glm(events~conc + age,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
pop <- fblad1$at.risk
pop <- fblad1$at.risk
analysis<-glm(events~conc + age + pop,family=poisson(link=log),data=fblad1)
# sæt en formel til glm
conc <- fblad1$conc
age <- fblad1$age
pop <- fblad1$at.risk
analysis<-glm(events~conc + age + pop,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
events123 <- fblad1$events
analysis<-glm(events~conc + age + pop,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
analysis<-glm(events~conc + age + pop + events123,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# sæt en formel til glm
conc <- fblad1$conc
age <- fblad1$age
pop <- fblad1$at.risk
analysis<-glm(events~conc + age + pop + sqrt(conc),family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original<-exp(prediction.data)
# plots i log transformation
plot(var,prediction.data$pred, col="blue")
lines(var,prediction.data$lower, col="red")
lines(var,prediction.data$upper, col="red")
#index for undersøgelses punkt
i1 <- 255
# sandsynlighhed for at få kræft i indexpunktet
p1 <- fblad1$events[i1]/fblad1$at.risk[i1]*100
#plot af sandsynlighed for kræft i orginal data
plot(prediction.data.original$pred,var)
lines(prediction.data.original$lower,var, col="red")
lines(prediction.data.original$upper,var, col="red")
points(var[i1],p1,col="green")
analysis<-glm(events~conc + age + sqrt(conc),family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original<-exp(prediction.data)
# plots i log transformation
plot(var,prediction.data$pred, col="blue")
lines(var,prediction.data$lower, col="red")
lines(var,prediction.data$upper, col="red")
#index for undersøgelses punkt
i1 <- 255
# sandsynlighhed for at få kræft i indexpunktet
p1 <- fblad1$events[i1]/fblad1$at.risk[i1]*100
#plot af sandsynlighed for kræft i orginal data
plot(prediction.data.original$pred,var)
lines(prediction.data.original$lower,var, col="red")
lines(prediction.data.original$upper,var, col="red")
analysis<-glm(events~conc + age + sqrt(conc),family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
analysis<-glm(events~conc + age,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original<-exp(prediction.data)
# plots i log transformation
plot(var,prediction.data$pred, col="blue")
lines(var,prediction.data$lower, col="red")
analysis<-glm(events~conc + age,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
prediction.data.original<-invlogit(prediction.data)
prediction.data.original<-invlog(prediction.data)
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
fblad1 <- fblad[c(15:549), ]
N <- length(fblad1$events)
p.hat <- sum(fblad1$events/N)
# sæt en formel til glm
conc <- fblad1$conc
age <- fblad1$age
pop <- fblad1$at.risk
analysis<-glm(events~conc + age,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original<-exp(prediction.data)
# plots i log transformation
plot(var,prediction.data$pred, col="blue")
lines(var,prediction.data$lower, col="red")
lines(var,prediction.data$upper, col="red")
#index for undersøgelses punkt
i1 <- 255
# sandsynlighhed for at få kræft i indexpunktet
p1 <- fblad1$events[i1]/fblad1$at.risk[i1]*100
#plot af sandsynlighed for kræft i orginal data
plot(prediction.data.original$pred,var)
lines(prediction.data.original$lower,var, col="red")
lines(prediction.data.original$upper,var, col="red")
points(var[i1],p1,col="green")
lines(var,prediction.data$upper, col="red")
#index for undersøgelses punkt
i1 <- 255
# sandsynlighhed for at få kræft i indexpunktet
p1 <- fblad1$events[i1]/fblad1$at.risk[i1]*100
#plot af sandsynlighed for kræft i orginal data
plot(prediction.data.original$pred,var)
lines(prediction.data.original$lower,var, col="red")
lines(prediction.data.original$upper,var, col="red")
#plot af sandsynlighed for kræft i orginal data
plot(prediction.data.original$pred,var)
?glm
??glm
?glm
okay
2+2
123+123+123
123*3
123*5
123*6
123*
8
123*8
123*8,2
123*8.2
123*8.1
123*8.15
123*8.12
123*8.123
123*8.123123
123*8.123123123123123123123123123123123123123
# Joachim wd
setwd("/Users/JoachimPorsA/Documents/4. Semester - DTU/Fagprojekt/Data/Arsenik i vand/Data")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
# Antal observationer
N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
# Her defineres modellen:
analysis<-glm(events~conc + age,family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Her defineres modellen:
analysis<-glm(events~conc + age + log(at.risk),family=poisson(link=log),data=fblad1)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original<-exp(prediction.data)
#Oskar wd
setwd("C:\\Users\\User\\OneDrive - Danmarks Tekniske Universitet\\SAS_030919\\4. Semester\\42584_Fagprojekt\\Arsenik i drikkevand\\42584_Data\\arsenik_i_vand\\Data")
#Oskar wd
setwd("C:\\Users\\User\\OneDrive - Danmarks Tekniske Universitet\\SAS_030919\\4. Semester\\42584_Fagprojekt\\Arsenik i drikkevand\\42584_Data\\Arsenik_i_vand\\Data")
#Oskar wd
setwd("C:\\Users\\User\\OneDrive - Danmarks Tekniske Universitet\\SAS_030919\\4. Semester\\42584_Fagprojekt\\Arsenik i drikkevand\\42584_Data\\Arsenik i vand\\Data")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
# Antal observationer
N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Transformerer dataen tilbage til original tilstand og sorterer data efter pred
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(prediction.data.original$pred),]
source('C:/Users/User/OneDrive - Danmarks Tekniske Universitet/SAS_030919/4. Semester/42584_Fagprojekt/Arsenik i drikkevand/42584_Data/Arsenik i vand/R/Analyse.r', encoding = 'UTF-8', echo=TRUE)
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
#plot i log data
plot(prediction.data$pred, fblad$events[order(prediction.data$pred)], col="blue")
lines(prediction.data$lower, fblad$events, col="red")
lines(prediction.data$upper, fblad$events, col="red")
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# Her defineres modellen:
analysis<-glm(events~conc^2+age^2,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
analysis<-glm(events~conc^2+age^2,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
#Oskar wd
setwd("C:\\Users\\User\\OneDrive - Danmarks Tekniske Universitet\\SAS_030919\\4. Semester\\42584_Fagprojekt\\Arsenik i drikkevand\\42584_Data\\Arsenik i vand\\Data")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
# Antal observationer
N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
analysis<-glm(events~conc^2+age^2,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
# Transformerer dataen tilbage til original tilstand og sorterer data efter pred
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(prediction.data.original$pred),]
# Sorterede plots i original data transformation
plot(prediction.data.original$pred, fblad$events[order(prediction.data.original$pred)], col="blue")
lines(prediction.data.original$lower, fblad$events[order(prediction.data.original$pred)], col="red")
lines(prediction.data.original$upper, fblad$events[order(prediction.data.original$pred)], col="red")
#plot i log transformation
plot(prediction.data$pred, fblad$events[order(prediction.data$pred)], col="blue")
lines(prediction.data$lower, fblad$events, col="red")
lines(prediction.data$upper, fblad$events, col="red")
# Histogram over log transformeret procent for at få kræft
hist(log(fblad$events/fblad$at.risk))
# Data til histogrammet oven over
cbind(fblad[fblad$events>4,] ,log(fblad$events/fblad$at.risk)[fblad$events > 4])
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
#plot i log data
plot(prediction.data$pred, fblad$events[order(prediction.data$pred)], col="blue")
lines(prediction.data$lower, fblad$events, col="red")
lines(prediction.data$upper, fblad$events, col="red")
#Oskar wd
setwd("C:\\Users\\User\\OneDrive - Danmarks Tekniske Universitet\\SAS_030919\\4. Semester\\42584_Fagprojekt\\Arsenik i drikkevand\\42584_Data\\arsenik_i_vand\\Data")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
# Antal observationer
N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
# Transformerer dataen tilbage til original tilstand og sorterer data efter pred
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(prediction.data.original$pred),]
# Sorterede plots i original data transformation
plot(prediction.data.original$pred, fblad$events[order(prediction.data.original$pred)], col="blue")
lines(prediction.data.original$lower, fblad$events[order(prediction.data.original$pred)], col="red")
lines(prediction.data.original$upper, fblad$events[order(prediction.data.original$pred)], col="red")
#plot i log transformation
plot(prediction.data$pred, fblad$events[order(prediction.data$pred)], col="blue")
lines(prediction.data$lower, fblad$events, col="red")
lines(prediction.data$upper, fblad$events, col="red")
# Histogram over log transformeret procent for at få kræft
hist(log(fblad$events/fblad$at.risk))
# Data til histogrammet oven over
cbind(fblad[fblad$events>4,] ,log(fblad$events/fblad$at.risk)[fblad$events > 4])
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
#plot i log data
plot(prediction.data$pred, fblad$events[order(prediction.data$pred)], col="blue")
lines(prediction.data$lower, fblad$events, col="red")
lines(prediction.data$upper, fblad$events, col="red")
#Oskar wd
setwd("C:\\Users\\User\\OneDrive - Danmarks Tekniske Universitet\\SAS_030919\\4. Semester\\42584_Fagprojekt\\Arsenik i drikkevand\\42584_Data\\arsenik_i_vand\\Data")
source('C:/Users/User/OneDrive - Danmarks Tekniske Universitet/SAS_030919/4. Semester/42584_Fagprojekt/Arsenik i drikkevand/42584_Data/Arsenik i vand/R/Analyse.r', encoding = 'UTF-8', echo=TRUE)
#Oskar wd
setwd("C:\\Users\\User\\OneDrive - Danmarks Tekniske Universitet\\SAS_030919\\4. Semester\\42584_Fagprojekt\\Arsenik i drikkevand\\42584_Data\\arsenik_i_vand\\Data")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
# Antal observationer
N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
#Oskar wd
setwd("C:\\Users\\User\\OneDrive - Danmarks Tekniske Universitet\\SAS_030919\\4. Semester\\42584_Fagprojekt\\Arsenik i drikkevand\\42584_Data\\arsenik_i_vand\\Data")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
# Antal observationer
N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
# Her defineres modellen:
analysis<-glm(events~sqrt(conc)+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(sqrt(conc)^2)+I(age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 25), ylim=c(0, 25))
fblad$events[order(fblad$events, decreasing = TRUE)]
