N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(prediction.data.original$pred),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events[order(prediction.data.original$pred)], col="blue")
lines(prediction.data.original$lower, fblad$events[order(prediction.data.original$pred)], col="red")
lines(prediction.data.original$upper, fblad$events[order(prediction.data.original$pred)], col="red")
#plot i log data
plot(prediction.data$pred, fblad$events[order(prediction.data$pred)], col="blue")
lines(prediction.data$lower, fblad$events, col="red")
lines(prediction.data$upper, fblad$events, col="red")
hist(log(fblad$events/fblad$at.risk))
cbind(fblad[fblad$events>4,] ,log(fblad$events/fblad$at.risk)[fblad$events > 4])
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
analysis2 <- update(analysis2, ~.+I(conc^3))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
#analysis2 <- update(analysis2, ~.+I(conc^3))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
hist(log(fblad$events/fblad$at.risk))
cbind(fblad[fblad$events>4,] ,log(fblad$events/fblad$at.risk)[fblad$events > 4])
source('~/DTU/4. Semester/Fagprojekt/ArsenikGit/R/Analyse.r', encoding = 'UTF-8', echo=TRUE)
source('~/DTU/4. Semester/Fagprojekt/ArsenikGit/R/Analyse.r', encoding = 'UTF-8', echo=TRUE)
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = FALSE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = true),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = FALSE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
source('~/DTU/4. Semester/Fagprojekt/ArsenikGit/R/Analyse.r', encoding = 'UTF-8', echo=TRUE)
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
# Transformerer dataen tilbage til original tilstand og sorterer data efter pred
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(prediction.data.original$pred),]
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
analysis2 <- update(analysis, ~.+I(conc^3)+I(age^3))
summary(analysis2)
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
analysis2 <- update(analysis, ~.+I(conc^3)+I(age^3))
summary(analysis2)
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
analysis2 <- update(analysis2, ~.+I(conc^3)+I(age^3))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
plot(prediction.data.original$pred/fblad$at.risk, fblad$events/fblad$at.risk, col="blue")
cbind(fblad[fblad$events,] ,prediction.data.original$pred)
cbind(fblad$events,prediction.data.original$pred)
cbind(fblad$events[order(fblad$events, decreasing = TRUE),],prediction.data.original$pred)
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],prediction.data.original$pred)
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred))
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred),1)
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,4))
plot(fblad$events[order(fblad$events, decreasing = TRUE)<4],round(prediction.data.original$pred,4))[<4]
plot(fblad$events[order(fblad$events, decreasing = TRUE)<4],round(prediction.data.original$pred,4))
fblad$events[order(fblad$events, decreasing = TRUE)<4]
fblad$events[order(fblad$events, decreasing = TRUE)]
fblad$events[order(fblad$events, decreasing = TRUE)][fblad$events<4]
fblad$events[order(fblad$events, decreasing = TRUE)][fblad$events<8]
fblad$events[order(fblad$events, decreasing = TRUE)][fblad$events<4]
fblad$events[order(fblad$events, decreasing = TRUE)][fblad$events<8]
fblad$events[order(fblad$events, decreasing = TRUE)][fblad$events<10]
fblad$events[order(fblad$events<4, decreasing = TRUE)]
fblad$events[order(fblad$events, decreasing = TRUE)]
fblad$events[order(fblad$events[<15], decreasing = TRUE)]
fblad$events[order(fblad$events[15:], decreasing = TRUE)]
fblad$events[order(fblad$events[15:559], decreasing = TRUE)]
fblad$events[order(fblad$events, decreasing = TRUE)]
plot(fblad$events[order(fblad$events, decreasing = TRUE)<4],round(prediction.data.original$pred,4))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,4))
fblad <- fblad[c(15:549), ]
# Antal observationer
N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,4))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
# Transformerer dataen tilbage til original tilstand og sorterer data efter pred
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(prediction.data.original$pred),]
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0))
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0))
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
summary(analysis2)
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
analysis2 <- update(analysis2, ~.+I(conc^3)+I(age^3))
summary(analysis2)
#plot i log data
plot(prediction.data$pred, fblad$events[order(prediction.data$pred)], col="blue")
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
# Antal observationer
N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
# Transformerer dataen tilbage til original tilstand og sorterer data efter pred
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(prediction.data.original$pred),]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0))
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1), xlim=c(0, 4), ylim=c(0, 4)))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1), xlim=c(0, 4), ylim=c(0, 4))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,4), xlim=c(0, 4), ylim=c(0, 4))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0), xlim=c(0, 4), ylim=c(0, 4))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0), xlim=c(0, 8), ylim=c(0, 8))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0), xlim=c(0, 15), ylim=c(0, 15))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0), xlim=c(0, 25), ylim=c(0, 25))
# Her defineres modellen:
analysis<-glm(events~conc+sqrt(age),family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(conc^2)+I(sqrt(age)^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0), xlim=c(0, 25), ylim=c(0, 25))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0), xlim=c(0, 25), ylim=c(0, 25))
# Her defineres modellen:
analysis<-glm(events~sqrt(conc)+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(sqrt(conc)^2)+I(age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0), xlim=c(0, 25), ylim=c(0, 25))
fblad$events[order(fblad$events, decreasing = TRUE)]
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0), xlim=c(0, 25), ylim=c(0, 25))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1), xlim=c(0, 25), ylim=c(0, 25))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,0), xlim=c(0, 25), ylim=c(0, 25))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 25), ylim=c(0, 25))
# Hvor god er modellen
drop1(analysis2, test="Chisq")
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Frederik wd
setwd("C:\\Users\\frede\\OneDrive\\Dokumenter\\DTU\\4. Semester\\Fagprojekt\\ArsenikGit\\Data")
fblad <- read.table("fblad.sw.dat", header=TRUE)
head(fblad)
# Antal observationer
N <- length(fblad$events)
# p.hat (empirisk sandsynlighed)
p.hat <- sum(fblad$events/N)
# Her defineres modellen:
analysis<-glm(events~sqrt(conc)+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(sqrt(conc)^2)+I(age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 25), ylim=c(0, 25))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 85), ylim=c(0, 85))
fblad$events[order(fblad$events, decreasing = TRUE)]
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*sqrt(conc)^2)+I(1/2*age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# plots i original data transformation
plot(prediction.data.original$pred, fblad$events, col="blue")
lines(prediction.data.original$lower, fblad$events, col="red")
lines(prediction.data.original$upper, fblad$events, col="red")
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 85), ylim=c(0, 85))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Hvor god er modellen
drop1(analysis, test="Chisq")
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I(1/2*age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
fblad$events[order(fblad$events, decreasing = TRUE)]
# Her defineres modellen:
analysis<-glm(events~conc+sqrt(age),family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I((1/2*log(age))^2))
summary(analysis2)
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I((1/2*sqrt(age))^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
fblad$events[order(fblad$events, decreasing = TRUE)]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I((1/2*log(age))^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I((1/2*sqrt(age))^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I(1/2*(sqrt(age))^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
analysis2 <- update(analysis2, ~.+I(1/2*conc^3)+I(1/2*(sqrt(age))^3))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
analysis2 <- update(analysis2, ~.+I(1/2*conc^3))
summary(analysis2)
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I(1/2*(sqrt(age))^2))
analysis2 <- update(analysis2, ~.+I(1/2*conc^3))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I(1/2*age^2))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
# Her defineres modellen:
analysis<-glm(events~conc+age,family=poisson(link=log),data=fblad,offset=log(at.risk))
summary(analysis)
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I(1/2*age^2))
summary(analysis2)
analysis2 <- update(analysis2, ~.+I(1/2*conc^3))
summary(analysis2)
analysis2 <- update(analysis2, ~.+I(1/2*conc^3)+I(1/2*age^3))
summary(analysis2)
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I(1/2*age^2))
analysis2 <- update(analysis2, ~.+I(1/2*conc^3))
summary(analysis2)
# Hvor god er modellen
drop1(analysis2, test="Chisq")
# Laver signifikans niveauer
prediction.temp<-as.data.frame(predict(analysis2,se.fit=T))
prediction.data<-data.frame(pred=prediction.temp$fit, upper=prediction.temp$fit+ 1.96*prediction.temp$se.fit, lower=prediction.temp$fit-1.96*prediction.temp$se.fit)
prediction.data.original <- exp(prediction.data)
prediction.data.original <- prediction.data.original[order(fblad$events, decreasing = TRUE),]
# Laver foreløbig test, tror det her er den rigtige måde at plotte det på
cbind(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,1))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 85), ylim=c(0, 85))
plot(fblad$events[order(fblad$events, decreasing = TRUE)],round(prediction.data.original$pred,2), xlim=c(0, 5), ylim=c(0, 5))
plot(round(prediction.data.original$pred,2),fblad$events[order(fblad$events, decreasing = TRUE)], xlim=c(0, 5), ylim=c(0, 5))
plot(round(prediction.data.original$pred,2),fblad$events[order(fblad$events, decreasing = TRUE)], xlim=c(0, 85), ylim=c(0, 85))
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I(1/2*age^2))
summary(analysis2)
analysis2 <- update(analysis2, ~.+I(1/2*conc^3)+I(1/2*age^2))
analysis2 <- update(analysis2, ~.+I(1/2*conc^3)+I(1/2*age^3))
summary(analysis2)
analysis2 <- update(analysis2, ~.+I(1/2*conc^3))
summary(analysis2)
# Taylor udvider til ny analysis
analysis2 <- update(analysis, ~.+I(1/2*conc^2)+I(1/2*age^2))
analysis2 <- update(analysis2, ~.+I(1/2*conc^3))
summary(analysis2)
plot(round(prediction.data.original$pred,2),fblad$events[order(fblad$events, decreasing = TRUE)], xlim=c(0, 5), ylim=c(0, 5))
lines(0:5,0:5, type="l")
plot(round(prediction.data.original$pred,2),fblad$events[order(fblad$events, decreasing = TRUE)], xlim=c(0, 25), ylim=c(0, 25))
lines(0:25,0:25, type="l")
plot(round(prediction.data.original$pred,2),fblad$events[order(fblad$events, decreasing = TRUE)], xlim=c(0, 5), ylim=c(0, 5))
lines(0:25,0:25, type="l")
fblad$gender <- read.table("mblad.sw.dat", header=TRUE)
